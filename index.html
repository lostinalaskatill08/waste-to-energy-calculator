<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Waste-to-Energy Calculator</title>
    
    <!-- Required libraries -->
    <script src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
    <script src="https://unpkg.com/recharts/umd/Recharts.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;
        const { LineChart, Line, XAxis, YAxis, Tooltip, Legend, ResponsiveContainer, BarChart, Bar, Cell } = Recharts;

        const WasteToEnergyCalculator = () => {
            const [population, setPopulation] = useState('');
            const [results, setResults] = useState(null);
            const [rangeData, setRangeData] = useState([]);
            const [energyBreakdown, setEnergyBreakdown] = useState([]);

            // Constants for calculations
            const constants = {
                foodWastePerPerson: 435,
                plasticMSWPerPerson: 500,
                humanWastePerPerson: 50,
                agWastePerPerson: 120,
                methaneYieldPerTon: 100,
                electricityPerMethaneM3: 10,
                incinerationEfficiency: 0.42,
                gasificationEfficiency: 1.25,
                co2EquivalentSaved: 3.5,
                algaePerCo2: 0.25,
                biofuelPerAlgae: 0.6,
                householdEnergyUsage: 10500,
                landfillSpacePerTon: 1.5,
                electricityRate: 0.12
            };

            const calculateResults = (processingRate) => {
                if (!population) return null;
                
                const pop = parseFloat(population);
                
                // Basic waste calculations (tons)
                const totalFoodWaste = (pop * constants.foodWastePerPerson) / 1000;
                const totalPlasticMSW = (pop * constants.plasticMSWPerPerson) / 1000;
                const totalHumanWaste = (pop * constants.humanWastePerPerson) / 1000;
                const totalAgWaste = (pop * constants.agWastePerPerson) / 1000;

                // Processed amounts
                const processedFoodWaste = totalFoodWaste * processingRate;
                const processedPlasticMSW = totalPlasticMSW * processingRate;
                const processedHumanWaste = totalHumanWaste * processingRate;
                const processedAgWaste = totalAgWaste * processingRate;

                // Energy calculations
                const methaneFood = processedFoodWaste * constants.methaneYieldPerTon;
                const methaneHuman = processedHumanWaste * constants.methaneYieldPerTon;
                const electricityFood = methaneFood * constants.electricityPerMethaneM3;
                const electricityHuman = methaneHuman * constants.electricityPerMethaneM3;
                const electricityPlasticMSW = processedPlasticMSW * constants.incinerationEfficiency * 1000;
                const electricityAgWaste = processedAgWaste * constants.gasificationEfficiency * 1000;

                const totalEnergy = (electricityFood + electricityHuman + electricityPlasticMSW + electricityAgWaste) / 1000;
                const annualRevenue = totalEnergy * 1000 * constants.electricityRate;

                // Environmental calculations
                const co2Saved = (processedFoodWaste + processedHumanWaste) * constants.co2EquivalentSaved;
                const landfillSpaceSaved = (processedFoodWaste + processedPlasticMSW + processedHumanWaste) * constants.landfillSpacePerTon;
                const algaeProduced = co2Saved * constants.algaePerCo2;
                const biofuelProduced = algaeProduced * constants.biofuelPerAlgae;

                // Additional calculations for trees and vehicles
                const treesEquivalent = Math.floor(co2Saved * 46);
                const carsRemoved = Math.floor(co2Saved / 4.6);
                const gasolineSaved = Math.floor(co2Saved * 113);
                
                return {
                    totalEnergy,
                    householdsPowered: totalEnergy * 1000 / constants.householdEnergyUsage,
                    landfillSpaceSaved,
                    co2Saved,
                    algaeProduced,
                    biofuelProduced,
                    annualRevenue,
                    treesEquivalent,
                    carsRemoved,
                    gasolineSaved,
                    energyBreakdown: {
                        biogas: (electricityFood + electricityHuman) / 1000,
                        incineration: electricityPlasticMSW / 1000,
                        gasification: electricityAgWaste / 1000
                    }
                };
            };

            const handleCalculate = () => {
                // Generate range data from 5% to 100%
                const newRangeData = [];
                const breakdownData = [];
                
                for (let rate = 0.05; rate <= 1; rate += 0.05) {
                    const result = calculateResults(rate);
                    newRangeData.push({
                        rate: `${(rate * 100).toFixed(0)}%`,
                        energy: result.totalEnergy,
                        households: result.householdsPowered,
                        co2: result.co2Saved,
                        biofuel: result.biofuelProduced,
                        revenue: result.annualRevenue / 1000000 // Convert to millions
                    });

                    if (rate === 1) { // Store max values energy breakdown
                        breakdownData.push(
                            { name: 'Biogas', value: result.energyBreakdown.biogas },
                            { name: 'Incineration', value: result.energyBreakdown.incineration },
                            { name: 'Gasification', value: result.energyBreakdown.gasification }
                        );
                    }
                }
                
                setRangeData(newRangeData);
                setEnergyBreakdown(breakdownData);
                setResults({
                    min: calculateResults(0.05),
                    max: calculateResults(1.0)
                });
            };

            return (
                <div className="p-4">
                    <div className="max-w-6xl mx-auto">
                        <h1 className="text-2xl font-bold mb-4">Waste-to-Energy Calculator</h1>
                        
                        <div className="mb-6">
                            <input
                                type="number"
                                placeholder="Enter city population"
                                value={population}
                                onChange={(e) => setPopulation(e.target.value)}
                                className="p-2 border rounded mr-2"
                            />
                            <button
                                onClick={handleCalculate}
                                className="px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600"
                            >
                                Calculate
                            </button>
                        </div>

                        {results && (
                            <div className="space-y-8">
                                <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                                    <div className="p-4 bg-white rounded shadow">
                                        <h2 className="text-xl font-bold mb-3">Energy Generation</h2>
                                        <div className="space-y-2">
                                            <p>‚ö° Total Energy: {results.min.totalEnergy.toFixed(1)} - {results.max.totalEnergy.toFixed(1)} MWh</p>
                                            <p>üè† Households: {Math.floor(results.min.householdsPowered)} - {Math.floor(results.max.householdsPowered)}</p>
                                            <p>üí∞ Revenue: ${(results.min.annualRevenue/1000000).toFixed(2)}M - ${(results.max.annualRevenue/1000000).toFixed(2)}M</p>
                                        </div>
                                    </div>
                                    
                                    <div className="p-4 bg-white rounded shadow">
                                        <h2 className="text-xl font-bold mb-3">Environmental Impact</h2>
                                        <div className="space-y-2">
                                            <p>üåç CO‚ÇÇ Saved: {results.min.co2Saved.toFixed(1)} - {results.max.co2Saved.toFixed(1)} tons</p>
                                            <p>üöõ Landfill: {results.min.landfillSpaceSaved.toFixed(1)} - {results.max.landfillSpaceSaved.toFixed(1)} m¬≥</p>
                                            <p>üå± Algae: {results.min.algaeProduced.toFixed(1)} - {results.max.algaeProduced.toFixed(1)} tons</p>
                                            <p>‚õΩ Biofuel: {results.min.biofuelProduced.toFixed(1)} - {results.max.biofuelProduced.toFixed(1)} tons</p>
                                        </div>
                                    </div>

                                    <div className="p-4 bg-white rounded shadow">
                                        <h2 className="text-xl font-bold mb-3">Environmental Equivalents</h2>
                                        <div className="space-y-2">
                                            <p>üå≥ Trees: {results.min.treesEquivalent} - {results.max.treesEquivalent}</p>
                                            <p>üöó Cars Removed: {results.min.carsRemoved} - {results.max.carsRemoved}</p>
                                            <p>‚õΩ Gasoline Saved: {results.min.gasolineSaved} - {results.max.gasolineSaved} gal</p>
                                        </div>
                                    </div>
                                </div>

                                <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                                    <div className="h-64 bg-white rounded shadow p-4">
                                        <h3 className="text-lg font-bold mb-2">Energy & Revenue by Processing Rate</h3>
                                        <ResponsiveContainer width="100%" height="100%">
                                            <LineChart data={rangeData}>
                                                <XAxis dataKey="rate" />
                                                <YAxis yAxisId="left" />
                                                <YAxis yAxisId="right" orientation="right" />
                                                <Tooltip />
                                                <Legend />
                                                <Line yAxisId="left" type="monotone" dataKey="energy" stroke="#2563eb" name="Energy (MWh)" />
                                                <Line yAxisId="right" type="monotone" dataKey="revenue" stroke="#16a34a" name="Revenue (M$)" />
                                            </LineChart>
                                        </ResponsiveContainer>
                                    </div>

                                    <div className="h-64 bg-white rounded shadow p-4">
                                        <h3 className="text-lg font-bold mb-2">Maximum Energy Generation by Source</h3>
                                        <ResponsiveContainer width="100%" height="100%">
                                            <BarChart data={energyBreakdown} margin={{ top: 20, right: 30, left: 20, bottom: 5 }}>
                                                <XAxis dataKey="name" />
                                                <YAxis label={{ value: 'Energy (MWh)', angle: -90, position: 'insideLeft' }} />
                                                <Tooltip formatter={(value) => `${value.toFixed(1)} MWh`} />
                                                <Legend />
                                                <Bar dataKey="value" name="Energy Generation">
                                                    {energyBreakdown.map((entry, index) => (
                                                        <Cell key={`cell-${index}`} fill={
                                                            index === 0 ? '#2563eb' :  // Biogas
                                                            index === 1 ? '#16a34a' :  // Incineration
                                                            '#ef4444'                  // Gasification
                                                        } />
                                                    ))}
                                                </Bar>
                                            </BarChart>
                                        </ResponsiveContainer>
                                    </div>
                                </div>

                                <div className="bg-white rounded shadow p-6">
                                    <h2 className="text-xl font-bold mb-4">Calculator Assumptions & Methodology</h2>
                                    
                                    <div className="space-y-6">
                                        <div>
                                            <h3 className="font-bold mb-2">Waste Generation Rates (per person per year)</h3>
                                            <ul className="list-disc pl-6">
                                                <li>Food Waste: 435 kg</li>
                                                <li>Municipal Solid Waste/Plastic: 500 kg</li>
                                                <li>Human Waste (Biosolids): 50 kg</li>
                                                <li>Agricultural/Forestry Waste: 120 kg</li>
                                            </ul>
                                        </div>

                                        <div>
                                            <h3 className="font-bold mb-2">Energy Conversion Rates</h3>
                                            <ul className="list-disc pl-6">
                                                <li>Biogas Production: 100 m¬≥ methane per ton of food/human waste</li>
                                                <li>Biogas Energy Yield: 10 kWh per m¬≥ methane</li>
                                                <li>MSW Incineration Efficiency: 0.42 MWh per ton</li>
                                                <li>Biomass Gasification Efficiency: 1.25 MWh per ton</li>
                                            </ul>
                                        </div>

                                        <div>
                                            <h3 className="font-bold mb-2">Environmental Factors</h3>
                                            <ul className="list-disc pl-6">
                                                <li>CO‚ÇÇ Reduction: 3.5 tons of CO‚ÇÇ saved per ton of waste processed</li>
                                                <li>Algae Production: 0.25 tons of algae per ton of CO‚ÇÇ captured</li>
                                                <li>Biofuel Yield: 0.6 tons of biofuel per ton of algae produced</li>
                                                <li>Landfill Space Saved: 1.5 m¬≥ per ton of waste diverted</li>
                                            </ul>
                                        </div>

                                        <div>
                                            <h3 className="font-bold mb-2">Economic & Energy Assumptions</h3>
